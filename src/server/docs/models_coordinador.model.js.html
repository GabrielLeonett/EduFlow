<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>models/coordinador.model.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AdminController.html">AdminController</a></li><li><a href="AdminModel.html">AdminModel</a></li><li><a href="AdminService.html">AdminService</a></li><li><a href="AulaController.html">AulaController</a></li><li><a href="AulaModel.html">AulaModel</a></li><li><a href="AulaService.html">AulaService</a></li><li><a href="CoordinadorController.html">CoordinadorController</a></li><li><a href="CoordinadorService.html">CoordinadorService</a></li><li><a href="CurricularController.html">CurricularController</a></li><li><a href="CurricularModel.html">CurricularModel</a></li><li><a href="CurricularService.html">CurricularService</a></li><li><a href="DocumentServices.html">DocumentServices</a><ul class='methods'><li data-type='method'><a href="DocumentServices.html#.crearCeldaEstilizada">crearCeldaEstilizada</a></li><li data-type='method'><a href="DocumentServices.html#.crearDocumentoHorario">crearDocumentoHorario</a></li><li data-type='method'><a href="DocumentServices.html#.crearFilaInformacion">crearFilaInformacion</a></li><li data-type='method'><a href="DocumentServices.html#.crearFilasTabla">crearFilasTabla</a></li><li data-type='method'><a href="DocumentServices.html#.crearParrafoEstilizado">crearParrafoEstilizado</a></li><li data-type='method'><a href="DocumentServices.html#.crearTextoEstilizado">crearTextoEstilizado</a></li><li data-type='method'><a href="DocumentServices.html#.generarDocumentoHorario">generarDocumentoHorario</a></li><li data-type='method'><a href="DocumentServices.html#.generarHorasDisponibles">generarHorasDisponibles</a></li><li data-type='method'><a href="DocumentServices.html#.procesarHorario">procesarHorario</a></li><li data-type='method'><a href="DocumentServices.html#.traerLogoMarcaAgua">traerLogoMarcaAgua</a></li></ul></li><li><a href="EmailService.html">EmailService</a></li><li><a href="FormatterResponseController.html">FormatterResponseController</a></li><li><a href="FormatterResponseModel.html">FormatterResponseModel</a></li><li><a href="FormatterResponseService.html">FormatterResponseService</a></li><li><a href="HorarioController.html">HorarioController</a></li><li><a href="HorarioService.html">HorarioService</a></li><li><a href="NotificationController.html">NotificationController</a></li><li><a href="ProfesorController.html">ProfesorController</a></li><li><a href="ProfesorModel.html">ProfesorModel</a></li><li><a href="ProfesorService.html">ProfesorService</a></li><li><a href="SedeController.html">SedeController</a></li><li><a href="SedeModel.html">SedeModel</a></li><li><a href="SedeService.html">SedeService</a></li><li><a href="SystemController.html">SystemController</a></li><li><a href="SystemModel.html">SystemModel</a></li><li><a href="UserController.html">UserController</a></li><li><a href="UserModel.html">UserModel</a></li><li><a href="UserService.html">UserService</a></li><li><a href="ValidationService.html">ValidationService</a></li><li><a href="module.exports_module.exports.html">exports</a></li></ul><h3>Modules</h3><ul><li><a href="module-CoordinadorModel.html">CoordinadorModel</a><ul class='methods'><li data-type='method'><a href="module-CoordinadorModel.html#.actualizarCoordinador">actualizarCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.asignarCoordinador">asignarCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.destituirCoordinador">destituirCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerCoordinador">obtenerCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerCoordinadorPorId">obtenerCoordinadorPorId</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerCoordinadorPorPnf">obtenerCoordinadorPorPnf</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerCoordinadoresActivos">obtenerCoordinadoresActivos</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerDatosCoordinadorCompletos">obtenerDatosCoordinadorCompletos</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerHistorialCoordinador">obtenerHistorialCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerHistorialDestituciones">obtenerHistorialDestituciones</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.obtenerTodos">obtenerTodos</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.reasignarCoordinador">reasignarCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.restituirCoordinador">restituirCoordinador</a></li><li data-type='method'><a href="module-CoordinadorModel.html#.validarCoordinadorActivo">validarCoordinadorActivo</a></li></ul></li><li><a href="module-CurricularRouter.html">CurricularRouter</a></li><li><a href="module-passwordUtils.html">passwordUtils</a><ul class='methods'><li data-type='method'><a href="module-passwordUtils.html#~comparePassword">comparePassword</a></li><li data-type='method'><a href="module-passwordUtils.html#~generarPassword">generarPassword</a></li><li data-type='method'><a href="module-passwordUtils.html#~hashPassword">hashPassword</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html">CrearSecciones</a></li><li><a href="global.html#DELETE/admins/:id">DELETE /admins/:id</a></li><li><a href="global.html#DELETE/aulas/:id">DELETE /aulas/:id</a></li><li><a href="global.html#DELETE/coordinadores/:id/destituir">DELETE /coordinadores/:id/destituir</a></li><li><a href="global.html#DELETE/horarios/:id">DELETE /horarios/:id</a></li><li><a href="global.html#DELETE/profesores/:id">DELETE /profesores/:id</a></li><li><a href="global.html#DELETE/profesores/:id_profesor/disponibilidad/:id_disponibilidad">DELETE /profesores/:id_profesor/disponibilidad/:id_disponibilidad</a></li><li><a href="global.html#DELETE/sedes/:id">DELETE /sedes/:id</a></li><li><a href="global.html#DELETE/system/backups/:backupFileName">DELETE /system/backups/:backupFileName</a></li><li><a href="global.html#DELETE/system/backups/cleanup">DELETE /system/backups/cleanup</a></li><li><a href="global.html#DELETE/user/:id_usuario/desactivar">DELETE /user/:id_usuario/desactivar</a></li><li><a href="global.html#EMAIL_CONFIG">EMAIL_CONFIG</a></li><li><a href="global.html#EnviarTokenEmail">EnviarTokenEmail</a></li><li><a href="global.html#GET/admin/logs">GET /admin/logs</a></li><li><a href="global.html#GET/admin/profile">GET /admin/profile</a></li><li><a href="global.html#GET/admin/reports">GET /admin/reports</a></li><li><a href="global.html#GET/admin/stats">GET /admin/stats</a></li><li><a href="global.html#GET/admins">GET /admins</a></li><li><a href="global.html#GET/admins/search">GET /admins/search</a></li><li><a href="global.html#GET/api/aulas">GET /api/aulas</a></li><li><a href="global.html#GET/api/profesores">GET /api/profesores</a></li><li><a href="global.html#GET/api/system/backups">GET /api/system/backups</a></li><li><a href="global.html#GET/api/system/estadisticas">GET /api/system/estadisticas</a></li><li><a href="global.html#GET/api/system/metricas">GET /api/system/metricas</a></li><li><a href="global.html#GET/api/system/status">GET /api/system/status</a></li><li><a href="global.html#GET/auditory/system">GET /auditory/system</a></li><li><a href="global.html#GET/aulas">GET /aulas</a></li><li><a href="global.html#GET/aulas/:id">GET /aulas/:id</a></li><li><a href="global.html#GET/aulas/pnf/:codigoPNF">GET /aulas/pnf/:codigoPNF</a></li><li><a href="global.html#GET/aulas/sede/:sede">GET /aulas/sede/:sede</a></li><li><a href="global.html#GET/aulas/tipo/:tipo">GET /aulas/tipo/:tipo</a></li><li><a href="global.html#GET/auth/verify">GET /auth/verify</a></li><li><a href="global.html#GET/catalogos/areas-conocimiento">GET /catalogos/areas-conocimiento</a></li><li><a href="global.html#GET/catalogos/posgrados">GET /catalogos/posgrados</a></li><li><a href="global.html#GET/catalogos/pregrados">GET /catalogos/pregrados</a></li><li><a href="global.html#GET/coordinadores">GET /coordinadores</a></li><li><a href="global.html#GET/coordinadores/:id">GET /coordinadores/:id</a></li><li><a href="global.html#GET/coordinadores/:id/historial-destituciones">GET /coordinadores/:id/historial-destituciones</a></li><li><a href="global.html#GET/coordinadores/destituidos">GET /coordinadores/destituidos</a></li><li><a href="global.html#GET/exportar/seccion/:id_seccion">GET /exportar/seccion/:id_seccion</a></li><li><a href="global.html#GET/horarios/aula/:id_aula">GET /horarios/aula/:id_aula</a></li><li><a href="global.html#GET/horarios/profesor/:id_profesor">GET /horarios/profesor/:id_profesor</a></li><li><a href="global.html#GET/horarios/seccion/:id_seccion">GET /horarios/seccion/:id_seccion</a></li><li><a href="global.html#GET/notifications">GET /notifications</a></li><li><a href="global.html#GET/profesores">GET /profesores</a></li><li><a href="global.html#GET/profesores/:id">GET /profesores/:id</a></li><li><a href="global.html#GET/profesores/:id/imagen">GET /profesores/:id/imagen</a></li><li><a href="global.html#GET/profesores/search">GET /profesores/search</a></li><li><a href="global.html#GET/profile">GET /profile</a></li><li><a href="global.html#GET/sedes">GET /sedes</a></li><li><a href="global.html#GET/sedes/:id">GET /sedes/:id</a></li><li><a href="global.html#GET/system/backups">GET /system/backups</a></li><li><a href="global.html#GET/system/backups/download/:backupFileName">GET /system/backups/download/:backupFileName</a></li><li><a href="global.html#GET/system/estado">GET /system/estado</a></li><li><a href="global.html#GET/system/info">GET /system/info</a></li><li><a href="global.html#GET/system/logs">GET /system/logs</a></li><li><a href="global.html#GET/system/mapa-calor/horarios">GET /system/mapa-calor/horarios</a></li><li><a href="global.html#GET/system/metricas/academicas">GET /system/metricas/academicas</a></li><li><a href="global.html#GET/system/metricas/sistema">GET /system/metricas/sistema</a></li><li><a href="global.html#GET/system/reportes/estadisticas">GET /system/reportes/estadisticas</a></li><li><a href="global.html">GuardarTokenEmail</a></li><li><a href="global.html#PATCH/admins/:id/rol">PATCH /admins/:id/rol</a></li><li><a href="global.html#POST/admins">POST /admins</a></li><li><a href="global.html#POST/aulas">POST /aulas</a></li><li><a href="global.html#POST/aulas/to/horarios">POST /aulas/to/horarios</a></li><li><a href="global.html#POST/auth/login">POST /auth/login</a></li><li><a href="global.html#POST/catalogos/areas-conocimiento">POST /catalogos/areas-conocimiento</a></li><li><a href="global.html#POST/catalogos/posgrados">POST /catalogos/posgrados</a></li><li><a href="global.html#POST/catalogos/pregrados">POST /catalogos/pregrados</a></li><li><a href="global.html#POST/coordinadores">POST /coordinadores</a></li><li><a href="global.html#POST/coordinadores/:id/restitur">POST /coordinadores/:id/restitur</a></li><li><a href="global.html#POST/horarios">POST /horarios</a></li><li><a href="global.html#POST/profesores">POST /profesores</a></li><li><a href="global.html#POST/profesores/:id/disponibilidad">POST /profesores/:id/disponibilidad</a></li><li><a href="global.html#POST/profesores/:id/reingresar">POST /profesores/:id/reingresar</a></li><li><a href="global.html#POST/profesores/to/seccion/:id_seccion">POST /profesores/to/seccion/:id_seccion</a></li><li><a href="global.html#POST/sedes">POST /sedes</a></li><li><a href="global.html#POST/system/backup">POST /system/backup</a></li><li><a href="global.html#POST/system/backup/manual">POST /system/backup/manual</a></li><li><a href="global.html#POST/system/restore">POST /system/restore</a></li><li><a href="global.html#PUT/admin/profile">PUT /admin/profile</a></li><li><a href="global.html#PUT/admins/:id">PUT /admins/:id</a></li><li><a href="global.html#PUT/aulas/:id">PUT /aulas/:id</a></li><li><a href="global.html#PUT/auth/password">PUT /auth/password</a></li><li><a href="global.html#PUT/coordinadores/:cedula/reasignar-pnf">PUT /coordinadores/:cedula/reasignar-pnf</a></li><li><a href="global.html#PUT/coordinadores/:id">PUT /coordinadores/:id</a></li><li><a href="global.html#PUT/horarios/:id">PUT /horarios/:id</a></li><li><a href="global.html#PUT/profesores/:id">PUT /profesores/:id</a></li><li><a href="global.html#PUT/profesores/:id_profesor/disponibilidad">PUT /profesores/:id_profesor/disponibilidad</a></li><li><a href="global.html#PUT/sedes/:id">PUT /sedes/:id</a></li><li><a href="global.html#PUT/user/:id_usuario/activar">PUT /user/:id_usuario/activar</a></li><li><a href="global.html">VerificarToken</a></li><li><a href="global.html">activar</a></li><li><a href="global.html">activarUsuario</a></li><li><a href="global.html">actualizar</a></li><li><a href="global.html">actualizarAdmin</a></li><li><a href="global.html">actualizarAula</a></li><li><a href="global.html">actualizarContrase√±aYLimpiarToken</a></li><li><a href="global.html">actualizarCoordinador</a></li><li><a href="global.html">actualizarDescripcionTrayecto</a></li><li><a href="global.html">actualizarDisponibilidad</a></li><li><a href="global.html#actualizarHorario">actualizarHorario</a></li><li><a href="global.html">actualizarPNF</a></li><li><a href="global.html">actualizarPerfil</a></li><li><a href="global.html#actualizarProfesor">actualizarProfesor</a></li><li><a href="global.html">actualizarSede</a></li><li><a href="global.html">actualizarUltimoAcceso</a></li><li><a href="global.html">actualizarUnidadCurricular</a></li><li><a href="global.html#agregarRolDestinatario">agregarRolDestinatario</a></li><li><a href="global.html#agregarUsuarioDestinatario">agregarUsuarioDestinatario</a></li><li><a href="global.html#asegurarStringEnMinusculas">asegurarStringEnMinusculas</a></li><li><a href="global.html">asignacionTurnoSeccion</a></li><li><a href="global.html">asignarCoordinador</a></li><li><a href="global.html">asignarTurnoSeccion</a></li><li><a href="global.html">buscar</a></li><li><a href="global.html">buscarAdmin</a></li><li><a href="global.html">buscarPorEmail</a></li><li><a href="global.html">buscarPorId</a></li><li><a href="global.html#buscarProfesor">buscarProfesor</a></li><li><a href="global.html">cambiarContrase√±a</a></li><li><a href="global.html">cambiarRol</a></li><li><a href="global.html">cambiarRolAdmin</a></li><li><a href="global.html">cerrarSesion</a></li><li><a href="global.html#closeSession">closeSession</a></li><li><a href="global.html">conflict</a></li><li><a href="global.html#connectDB">connectDB</a></li><li><a href="global.html">contarPorRolYEstado</a></li><li><a href="global.html#corsOptions">corsOptions</a></li><li><a href="global.html">crear</a></li><li><a href="global.html">crearAreaConocimiento</a></li><li><a href="global.html">crearDisponibilidad</a></li><li><a href="global.html#crearNotificacionCompleta">crearNotificacionCompleta</a></li><li><a href="global.html#crearNotificacionIndividual">crearNotificacionIndividual</a></li><li><a href="global.html#crearNotificacionMasiva">crearNotificacionMasiva</a></li><li><a href="global.html">crearPosgrado</a></li><li><a href="global.html">crearPregrado</a></li><li><a href="global.html">crearRespaldo</a></li><li><a href="global.html">crearSecciones</a></li><li><a href="global.html#crearSede">crearSede</a></li><li><a href="global.html#createValidationResponse">createValidationResponse</a></li><li><a href="global.html">created</a></li><li><a href="global.html">desactivar</a></li><li><a href="global.html">desactivarAdmin</a></li><li><a href="global.html">desactivarUsuario</a></li><li><a href="global.html#descargarRespaldo">descargarRespaldo</a></li><li><a href="global.html#destituirProfesor">destituirProfesor</a></li><li><a href="global.html#disconnectDB">disconnectDB</a></li><li><a href="global.html">eliminar</a></li><li><a href="global.html">eliminarAula</a></li><li><a href="global.html">eliminarCoordinador</a></li><li><a href="global.html">eliminarDisponibilidad</a></li><li><a href="global.html#eliminarHorario">eliminarHorario</a></li><li><a href="global.html">eliminarPnf</a></li><li><a href="global.html">eliminarRespaldo</a></li><li><a href="global.html">eliminarSede</a></li><li><a href="global.html">eliminarUnidadCurricular</a></li><li><a href="global.html#enviarEmail">enviarEmail</a></li><li><a href="global.html#enviarEmailMultiple">enviarEmailMultiple</a></li><li><a href="global.html">error</a></li><li><a href="global.html#exportarHorarioWord">exportarHorarioWord</a></li><li><a href="global.html">extractData</a></li><li><a href="global.html">extractError</a></li><li><a href="global.html">filtrarPorEstado</a></li><li><a href="global.html">filtrarPorRol</a></li><li><a href="global.html">filtrarPorSede</a></li><li><a href="global.html">filtrarPorTipo</a></li><li><a href="global.html">forbidden</a></li><li><a href="global.html">formatValidationErrors</a></li><li><a href="global.html">fromDatabaseResponse</a></li><li><a href="global.html#generarDocumentoHorario">generarDocumentoHorario</a></li><li><a href="global.html#generateEmailTemplate">generateEmailTemplate</a></li><li><a href="global.html#get/auth/logout">get /auth/logout</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html">getDefaultTitle</a></li><li><a href="global.html">getErrorCode</a></li><li><a href="global.html#getFilterCondition">getFilterCondition</a></li><li><a href="global.html#getImageProfesorDirect">getImageProfesorDirect</a></li><li><a href="global.html">getMinimalFallback</a></li><li><a href="global.html">getProfile</a></li><li><a href="global.html">getTranslation</a></li><li><a href="global.html">isError</a></li><li><a href="global.html">isSuccess</a></li><li><a href="global.html#joinRoleRooms">joinRoleRooms</a></li><li><a href="global.html#jsonSyntaxErrorHandler">jsonSyntaxErrorHandler</a></li><li><a href="global.html">limpiarRespaldosAntiguos</a></li><li><a href="global.html">listarCoordinadores</a></li><li><a href="global.html">listarCoordinadoresDestituidos</a></li><li><a href="global.html">listarRespaldos</a></li><li><a href="global.html#listenNotifications">listenNotifications</a></li><li><a href="global.html#loadEnv">loadEnv</a></li><li><a href="global.html">login</a></li><li><a href="global.html">loginUser</a></li><li><a href="global.html">manejarServicio</a></li><li><a href="global.html">marcarComoLeida</a></li><li><a href="global.html#markAsRead">markAsRead</a></li><li><a href="global.html#middlewareAuth">middlewareAuth</a></li><li><a href="global.html">mostrarAdmin</a></li><li><a href="global.html#mostrarAreasConocimiento">mostrarAreasConocimiento</a></li><li><a href="global.html#mostrarAulaCambiarHorario">mostrarAulaCambiarHorario</a></li><li><a href="global.html">mostrarAulas</a></li><li><a href="global.html#mostrarAulasParaHorario">mostrarAulasParaHorario</a></li><li><a href="global.html">mostrarDisponibilidad</a></li><li><a href="global.html#mostrarHorariosPorAula">mostrarHorariosPorAula</a></li><li><a href="global.html#mostrarHorariosPorSeccion">mostrarHorariosPorSeccion</a></li><li><a href="global.html#mostrarHorariosProfesores">mostrarHorariosProfesores</a></li><li><a href="global.html">mostrarLineasInvestigacion</a></li><li><a href="global.html">mostrarNotificacion</a></li><li><a href="global.html">mostrarPNF</a></li><li><a href="global.html#mostrarPosGrados">mostrarPosGrados</a></li><li><a href="global.html#mostrarPreGrados">mostrarPreGrados</a></li><li><a href="global.html#mostrarProfesor">mostrarProfesor</a></li><li><a href="global.html#mostrarProfesorAPI">mostrarProfesorAPI</a></li><li><a href="global.html#mostrarProfesorCambiarHorario">mostrarProfesorCambiarHorario</a></li><li><a href="global.html">mostrarProfesoresEliminados</a></li><li><a href="global.html#mostrarProfesoresParaHorario">mostrarProfesoresParaHorario</a></li><li><a href="global.html">mostrarSecciones</a></li><li><a href="global.html">mostrarSeccionesByPnfAndValueTrayecto</a></li><li><a href="global.html">mostrarSeccionesByPnfAndValueUnidadCurricular</a></li><li><a href="global.html">mostrarSedes</a></li><li><a href="global.html">mostrarTrayectos</a></li><li><a href="global.html">mostrarTurnos</a></li><li><a href="global.html">mostrarUnidadesCurriculares</a></li><li><a href="global.html">notFound</a></li><li><a href="global.html">obtenerAdminPorId</a></li><li><a href="global.html">obtenerAdminsPorEstado</a></li><li><a href="global.html">obtenerAdminsPorRol</a></li><li><a href="global.html">obtenerAreasConocimiento</a></li><li><a href="global.html#obtenerAuditoria">obtenerAuditoria</a></li><li><a href="global.html">obtenerAuditoriaCompleta</a></li><li><a href="global.html">obtenerAulaPorId</a></li><li><a href="global.html">obtenerAulasDisponibles</a></li><li><a href="global.html">obtenerAulasPorPnf</a></li><li><a href="global.html">obtenerAulasPorSede</a></li><li><a href="global.html">obtenerAulasPorTipo</a></li><li><a href="global.html">obtenerConFiltros</a></li><li><a href="global.html">obtenerCoordinador</a></li><li><a href="global.html">obtenerEstadoSistema</a></li><li><a href="global.html">obtenerHistorialDestituciones</a></li><li><a href="global.html#obtenerHorariosPorAula">obtenerHorariosPorAula</a></li><li><a href="global.html#obtenerHorariosPorProfesor">obtenerHorariosPorProfesor</a></li><li><a href="global.html#obtenerHorariosPorSeccion">obtenerHorariosPorSeccion</a></li><li><a href="global.html#obtenerIdUSerProfesor">obtenerIdUSerProfesor</a></li><li><a href="global.html">obtenerImagen</a></li><li><a href="global.html#obtenerInformacionSistema">obtenerInformacionSistema</a></li><li><a href="global.html#obtenerLogsSistema">obtenerLogsSistema</a></li><li><a href="global.html">obtenerMapaCalorHorarios</a></li><li><a href="global.html#obtenerMapaCalorOcupacion">obtenerMapaCalorOcupacion</a></li><li><a href="global.html">obtenerMetricasAcademicas</a></li><li><a href="global.html">obtenerMetricasSistema</a></li><li><a href="global.html">obtenerPerfil</a></li><li><a href="global.html#obtenerPorAula">obtenerPorAula</a></li><li><a href="global.html#obtenerPorId">obtenerPorId</a></li><li><a href="global.html#obtenerPorProfesor">obtenerPorProfesor</a></li><li><a href="global.html#obtenerPorSeccion">obtenerPorSeccion</a></li><li><a href="global.html">obtenerPosgrados</a></li><li><a href="global.html">obtenerPregrados</a></li><li><a href="global.html#obtenerProfesoresDisponibles">obtenerProfesoresDisponibles</a></li><li><a href="global.html">obtenerReportesEstadisticas</a></li><li><a href="global.html">obtenerRolesDisponibles</a></li><li><a href="global.html">obtenerSedePorId</a></li><li><a href="global.html">obtenerTodas</a></li><li><a href="global.html">obtenerTodos</a></li><li><a href="global.html">obtenerUnidadCurricularPorId</a></li><li><a href="global.html">obtenerUsuarioPorEmail</a></li><li><a href="global.html">obtenerUsuarioPorEmailConToken</a></li><li><a href="global.html">obtenerUsuarioPorId</a></li><li><a href="global.html">paginated</a></li><li><a href="global.html#parseJSONField">parseJSONField</a></li><li><a href="global.html#post/auth/logout">post /auth/logout</a></li><li><a href="global.html">quitarRol</a></li><li><a href="global.html">reactivarPnf</a></li><li><a href="global.html">reasignarCoordinador</a></li><li><a href="global.html#registerAreaConocimiento">registerAreaConocimiento</a></li><li><a href="global.html#registerAula">registerAula</a></li><li><a href="global.html#registerPosGrado">registerPosGrado</a></li><li><a href="global.html#registerPreGrado">registerPreGrado</a></li><li><a href="global.html#registerSede">registerSede</a></li><li><a href="global.html">registrarAdmin</a></li><li><a href="global.html">registrarAula</a></li><li><a href="global.html#registrarHorario">registrarHorario</a></li><li><a href="global.html">registrarLineaInvestigacion</a></li><li><a href="global.html">registrarLineasInvestigacion</a></li><li><a href="global.html">registrarPNF</a></li><li><a href="global.html#registrarProfesor">registrarProfesor</a></li><li><a href="global.html">registrarSede</a></li><li><a href="global.html">registrarUnidadCurricular</a></li><li><a href="global.html#regitrarPNF">regitrarPNF</a></li><li><a href="global.html#regitrarUnidadCurricular">regitrarUnidadCurricular</a></li><li><a href="global.html">reingresar</a></li><li><a href="global.html">reingresoProfesor</a></li><li><a href="global.html#reportesEstadisticas">reportesEstadisticas</a></li><li><a href="global.html">respuestaDatos</a></li><li><a href="global.html">respuestaError</a></li><li><a href="global.html">respuestaExito</a></li><li><a href="global.html">respuestaPaginada</a></li><li><a href="global.html">respuestaPostgres</a></li><li><a href="global.html">respuestaServicio</a></li><li><a href="global.html">respuestaSuccess</a></li><li><a href="global.html">respuestaValidacionError</a></li><li><a href="global.html">restaurarRespaldo</a></li><li><a href="global.html">restituirCoordinador</a></li><li><a href="global.html#searchNotificationDestinatario">searchNotificationDestinatario</a></li><li><a href="global.html#searchNotificationGlobales">searchNotificationGlobales</a></li><li><a href="global.html#searchNotificationRoles">searchNotificationRoles</a></li><li><a href="global.html#searchNotificationUser">searchNotificationUser</a></li><li><a href="global.html#searchNotifications">searchNotifications</a></li><li><a href="global.html#securityMiddleware">securityMiddleware</a></li><li><a href="global.html#sendToGlobals">sendToGlobals</a></li><li><a href="global.html#sendToRoles">sendToRoles</a></li><li><a href="global.html#sendToUser">sendToUser</a></li><li><a href="global.html#socketAuth">socketAuth</a></li><li><a href="global.html#storage">storage</a></li><li><a href="global.html">success</a></li><li><a href="global.html">unauthorized</a></li><li><a href="global.html">updateProfile</a></li><li><a href="global.html">validacionesComunes</a></li><li><a href="global.html#validarFormatoEmail">validarFormatoEmail</a></li><li><a href="global.html#validateAdmins">validateAdmins</a></li><li><a href="global.html#validateAreaConocimiento">validateAreaConocimiento</a></li><li><a href="global.html#validateAsignacionCoordinador">validateAsignacionCoordinador</a></li><li><a href="global.html#validateAula">validateAula</a></li><li><a href="global.html#validateContrasenia">validateContrasenia</a></li><li><a href="global.html#validateCoordinador">validateCoordinador</a></li><li><a href="global.html">validateCreacionSecciones</a></li><li><a href="global.html#validateDestitucion">validateDestitucion</a></li><li><a href="global.html#validateDisponibilidadDocente">validateDisponibilidadDocente</a></li><li><a href="global.html#validateHorario">validateHorario</a></li><li><a href="global.html#validateId">validateId</a></li><li><a href="global.html#validateLineaInvestigacion">validateLineaInvestigacion</a></li><li><a href="global.html#validateLogin">validateLogin</a></li><li><a href="global.html">validateNuevaAreaConocimiento</a></li><li><a href="global.html">validateNuevoPosgrado</a></li><li><a href="global.html">validateNuevoPregrado</a></li><li><a href="global.html#validatePartialAdmins">validatePartialAdmins</a></li><li><a href="global.html#validatePartialAreaConocimiento">validatePartialAreaConocimiento</a></li><li><a href="global.html#validatePartialAula">validatePartialAula</a></li><li><a href="global.html#validatePartialCoordinador">validatePartialCoordinador</a></li><li><a href="global.html#validatePartialDestitucion">validatePartialDestitucion</a></li><li><a href="global.html#validatePartialDisponibilidadDocente">validatePartialDisponibilidadDocente</a></li><li><a href="global.html#validatePartialHorario">validatePartialHorario</a></li><li><a href="global.html#validatePartialLogin">validatePartialLogin</a></li><li><a href="global.html#validatePartialPnf">validatePartialPnf</a></li><li><a href="global.html#validatePartialPosgrado">validatePartialPosgrado</a></li><li><a href="global.html#validatePartialPregrado">validatePartialPregrado</a></li><li><a href="global.html#validatePartialProfesor">validatePartialProfesor</a></li><li><a href="global.html#validatePartialSeccion">validatePartialSeccion</a></li><li><a href="global.html#validatePartialSede">validatePartialSede</a></li><li><a href="global.html#validatePartialUnidadCurricular">validatePartialUnidadCurricular</a></li><li><a href="global.html#validatePartialUser">validatePartialUser</a></li><li><a href="global.html#validatePnf">validatePnf</a></li><li><a href="global.html#validatePosgrado">validatePosgrado</a></li><li><a href="global.html#validatePregrado">validatePregrado</a></li><li><a href="global.html#validateProfesor">validateProfesor</a></li><li><a href="global.html#validateQueryParams">validateQueryParams</a></li><li><a href="global.html#validateRecoveryPassword">validateRecoveryPassword</a></li><li><a href="global.html#validateReingreso">validateReingreso</a></li><li><a href="global.html#validateRequiredFields">validateRequiredFields</a></li><li><a href="global.html#validateSeccion">validateSeccion</a></li><li><a href="global.html#validateSede">validateSede</a></li><li><a href="global.html#validateUnidadCurricular">validateUnidadCurricular</a></li><li><a href="global.html#validateUser">validateUser</a></li><li><a href="global.html">validationError</a></li><li><a href="global.html#verificarConexion">verificarConexion</a></li><li><a href="global.html#verificarConexionInternet">verificarConexionInternet</a></li><li><a href="global.html#verificarDependencias">verificarDependencias</a></li><li><a href="global.html#verificarEmailConAPI">verificarEmailConAPI</a></li><li><a href="global.html">verificarSesion</a></li><li><a href="global.html#verificarUsers">verificarUsers</a></li><li><a href="global.html#verificarYValidarEmails">verificarYValidarEmails</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">models/coordinador.model.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module CoordinadorModel
 * @description Modelo encargado exclusivamente de la interacci√≥n con la base de datos
 * para las operaciones relacionadas con los Coordinadores. Incluye asignaci√≥n,
 * desasignaci√≥n, listado, obtenci√≥n, actualizaci√≥n y eliminaci√≥n de coordinadores.
 */

// Importaciones principales
import pg from "../database/pg.js";
import FormatterResponseModel from "../utils/FormatterResponseModel.js";

export default class CoordinadorModel {
  /**
   * @static
   * @async
   * @method asignarCoordinador
   * @description Asigna un profesor como coordinador de un PNF mediante un procedimiento almacenado
   * @param {Object} datos - Datos de asignaci√≥n del coordinador
   * @param {number} id_usuario - ID del usuario que realiza la acci√≥n
   * @returns {Promise&lt;Object>} Resultado de la operaci√≥n
   */
  static async asignarCoordinador(datos, id_usuario) {
    try {
      const query = `CALL asignar_coordinador($1, $2, $3)`;
      const params = [id_usuario, datos.id_profesor, datos.id_pnf];
      console.log(params);
      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador asignado correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.asignarCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al asignar coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method validarCoordinadorActivo
   * @description Valida si un coordinador existe y est√° activo
   * @param {number} cedula_profesor - C√©dula del coordinador
   * @returns {Promise&lt;Object>} Informaci√≥n del coordinador
   */
  static async validarCoordinadorActivo(cedula_profesor) {
    try {
      console.log(
        "üîç [CoordinadorModel] Validando coordinador activo:",
        cedula_profesor
      );

      const query = `
      SELECT 
        c.id_coordinador,
        c.id_profesor,
        c.id_pnf,
        p.nombre_pnf,
        p.codigo_pnf,
        u.nombres,
        u.apellidos,
        u.email,
        c.activo,
        c.created_at
      FROM coordinadores c
      INNER JOIN pnfs p ON c.id_pnf = p.id_pnf
      INNER JOIN users u ON c.id_coordinador = u.cedula
      WHERE c.id_profesor = $1 AND c.activo = true
    `;

      const { rows } = await pg.query(query, [cedula_profesor]);

      console.log(rows);
      const coordinador = rows[0];

      return {
        existe: true,
        activo: coordinador.activo,
        id_coordinador: coordinador.id_coordinador,
        id_profesor: coordinador.id_profesor,
        pnf_actual: coordinador.id_pnf,
        pnf_nombre_actual: coordinador.nombre_pnf,
        pnf_codigo_actual: coordinador.codigo_pnf,
        nombre: `${coordinador.nombres} ${coordinador.apellidos}`,
        email: coordinador.email,
        fecha_designacion: coordinador.fecha_designacion,
        datos_completos: coordinador,
      };
    } catch (error) {
      console.error("‚ùå Error al validar coordinador activo:", error);
      throw error;
    }
  }

  /**
   * @static
   * @async
   * @method obtenerCoordinadorPorPnf
   * @description Obtiene el coordinador activo de un PNF espec√≠fico
   * @param {number} id_pnf - ID del PNF
   * @returns {Promise&lt;Object>} Informaci√≥n del coordinador
   */
  static async obtenerCoordinadorPorPnf(id_pnf) {
    try {
      console.log(
        "üîç [CoordinadorModel] Buscando coordinador por PNF:",
        id_pnf
      );

      const query = `
      SELECT 
        c.id_coordinador,
        c.id_profesor,
        u.cedula,
        u.nombres,
        u.apellidos,
        u.email,
        c.activo,
        c.created_at
      FROM coordinadores c
      INNER JOIN users u ON c.id_coordinador = u.cedula
      WHERE c.id_pnf = $1 AND c.activo = true
    `;

      const { rows } = await pg.query(query, [id_pnf]);

      if (rows.length === 0) {
        console.log("‚úÖ PNF sin coordinador activo");
        return null;
      }

      const coordinador = rows[0];
      console.log("‚úÖ Coordinador encontrado en PNF:", coordinador.nombres);

      return {
        id_coordinador: coordinador.id_coordinador,
        id_profesor: coordinador.id_profesor,
        cedula: coordinador.cedula,
        nombre: `${coordinador.nombres} ${coordinador.apellidos}`,
        email: coordinador.email,
        activo: coordinador.activo,
        fecha_asignacion: coordinador.created_at,
        fecha_designacion: coordinador.fecha_designacion,
      };
    } catch (error) {
      console.error("‚ùå Error al obtener coordinador por PNF:", error);
      throw error;
    }
  }

  /**
   * @static
   * @async
   * @method obtenerDatosCoordinadorCompletos
   * @description Obtiene todos los datos de un coordinador incluyendo informaci√≥n personal y profesional
   * @param {number} cedula_coordinador - C√©dula del coordinador
   * @returns {Promise&lt;Object>} Datos completos del coordinador
   */
  static async obtenerDatosCoordinadorCompletos(cedula_coordinador) {
    try {
      console.log(
        "üîç [CoordinadorModel] Obteniendo datos completos del coordinador:",
        cedula_coordinador
      );

      const query = `
      SELECT 
        -- Datos de usuario
        u.cedula,
        u.nombres,
        u.apellidos,
        u.email,
        u.telefono_movil,
        u.telefono_local,
        u.direccion,
        u.fecha_nacimiento,
        u.genero,
        
        -- Datos de coordinador
        c.id_coordinador,
        c.id_profesor,
        c.id_pnf,
        c.activo as coordinador_activo,
        c.fecha_designacion,
        c.created_at as fecha_asignacion,
        
        -- Datos del PNF
        p.nombre_pnf,
        p.codigo_pnf,
        p.descripcion as pnf_descripcion,
        
        -- Datos del profesor
        pr.categoria,
        pr.dedicacion,
        pr.fecha_ingreso,
        pr.estatus as estatus_profesor,
        
        -- √Åreas de conocimiento
        (
          SELECT JSON_AGG(ac.nombre_area)
          FROM areas_conocimiento ac
          INNER JOIN profesor_areas pa ON ac.id_area = pa.id_area
          WHERE pa.id_profesor = pr.id_profesor
        ) as areas_de_conocimiento,
        
        -- Formaci√≥n acad√©mica (pregrados)
        (
          SELECT JSON_AGG(
            JSON_BUILD_OBJECT(
              'titulo', fp.titulo,
              'institucion', fp.institucion,
              'anno_graduacion', fp.anno_graduacion,
              'completo', fp.titulo || ' - ' || fp.institucion || ' (' || fp.anno_graduacion || ')'
            )
          )
          FROM formacion_profesor fp
          WHERE fp.id_profesor = pr.id_profesor AND fp.tipo_formacion = 'pregrado'
        ) as pre_grados,
        
        -- Formaci√≥n acad√©mica (posgrados)
        (
          SELECT JSON_AGG(
            JSON_BUILD_OBJECT(
              'titulo', fp.titulo,
              'institucion', fp.institucion,
              'anno_graduacion', fp.anno_graduacion,
              'completo', fp.titulo || ' - ' || fp.institucion || ' (' || fp.anno_graduacion || ')'
            )
          )
          FROM formacion_profesor fp
          WHERE fp.id_profesor = pr.id_profesor AND fp.tipo_formacion = 'posgrado'
        ) as pos_grados,
        
        -- Disponibilidad
        (
          SELECT JSON_AGG(
            JSON_BUILD_OBJECT(
              'dia_semana', dd.dia_semana,
              'hora_inicio', dd.hora_inicio,
              'hora_fin', dd.hora_fin
            )
          )
          FROM disponibilidad_docente dd
          WHERE dd.id_profesor = pr.id_profesor AND dd.activo = true
        ) as disponibilidad,
        
        -- Horas disponibles
        (
          SELECT JSON_BUILD_OBJECT(
            'hours', COALESCE(SUM(EXTRACT(HOUR FROM (dd.hora_fin - dd.hora_inicio))), 0),
            'minutes', COALESCE(SUM(EXTRACT(MINUTE FROM (dd.hora_fin - dd.hora_inicio))), 0)
          )
          FROM disponibilidad_docente dd
          WHERE dd.id_profesor = pr.id_profesor AND dd.activo = true
        ) as horas_disponibles

      FROM coordinadores c
      INNER JOIN users u ON c.id_coordinador = u.cedula
      INNER JOIN pnfs p ON c.id_pnf = p.id_pnf
      INNER JOIN profesores pr ON c.id_profesor = pr.id_profesor
      WHERE c.id_coordinador = $1 AND c.activo = true
    `;

      const { rows } = await pg.query(query, [cedula_coordinador]);

      if (rows.length === 0) {
        return FormatterResponseModel.respuestaPostgres(
          [],
          "Coordinador no encontrado"
        );
      }

      return FormatterResponseModel.respuestaPostgres(
        rows[0],
        "Datos del coordinador obtenidos correctamente"
      );
    } catch (error) {
      console.error(
        "‚ùå Error al obtener datos completos del coordinador:",
        error
      );
      error.details = {
        path: "CoordinadorModel.obtenerDatosCoordinadorCompletos",
      };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener datos del coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerCoordinadoresActivos
   * @description Obtiene todos los coordinadores activos con informaci√≥n completa
   * @returns {Promise&lt;Object>} Lista de coordinadores activos
   */
  static async obtenerCoordinadoresActivos() {
    try {
      console.log("üîç [CoordinadorModel] Obteniendo coordinadores activos");

      const query = `
      SELECT 
        c.id_coordinador,
        c.id_profesor,
        u.cedula,
        u.nombres,
        u.apellidos,
        u.email,
        p.id_pnf,
        p.nombre_pnf,
        p.codigo_pnf,
        c.created_at
      FROM coordinadores c
      INNER JOIN users u ON c.id_coordinador = u.cedula
      INNER JOIN pnfs p ON c.id_pnf = p.id_pnf
      WHERE c.activo = true
      ORDER BY u.nombres, u.apellidos
    `;

      const { rows } = await pg.query(query);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinadores activos obtenidos correctamente"
      );
    } catch (error) {
      console.error("‚ùå Error al obtener coordinadores activos:", error);
      error.details = { path: "CoordinadorModel.obtenerCoordinadoresActivos" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener coordinadores activos"
      );
    }
  }

  /**
   * @static
   * @async
   * @method reasignarCoordinador
   * @description Reasigna un coordinador existente a otro PNF mediante un procedimiento almacenado
   * @param {Object} datos - Datos de reasignaci√≥n del coordinador
   * @param {number} id_usuario - ID del usuario que realiza la acci√≥n
   * @returns {Promise&lt;Object>} Resultado de la operaci√≥n
   */
  static async reasignarCoordinador(datos, id_usuario) {
    try {
      const query = `CALL reasignar_coordinador($1, $2, $3)`;
      const params = [id_usuario, datos.id_profesor, datos.id_pnf];
      console.log("üìã Par√°metros reasignaci√≥n:", params);

      const { rows } = await pg.query(query, params);
      console.log(rows);
      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador reasignado correctamente"
      );
    } catch (error) {
      console.log(error);
      error.details = { path: "CoordinadorModel.reasignarCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al reasignar coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerTodos
   * @description Obtener todos los coordinadores con soporte para par√°metros de consulta
   * @param {Object} queryParams - Par√°metros de consulta (paginaci√≥n, filtros, ordenamiento)
   * @returns {Promise&lt;Object>} Lista de coordinadores
   */
  static async obtenerTodos(queryParams = {}) {
    try {
      let query = `
      SELECT 
        id_coordinador,
        id_profesor,
        id_pnf,
        fecha_designacion,
        fecha_actualizacion,
        nombre_pnf,
        codigo_pnf,
        nombres,
        apellidos,
        cedula,
        telefono_movil,
        telefono_local,
        fecha_nacimiento,
        genero,
        email,
        direccion,
        fecha_ingreso,
        dedicacion,
        categoria,
        areas_de_conocimiento,
        disponibilidad,
        pre_grados,
        pos_grados,
        horas_disponibles,
        estatus_coordinador,
        anos_experiencia_coordinador
      FROM public.coordinadores_informacion_completa 
      WHERE 1=1
    `;
      const params = [];
      let paramCount = 0;

      // --- 1. Aplicar Filtros ---

      // Filtro por Estado (activo/inactivo)
      if (queryParams.estado !== undefined &amp;&amp; queryParams.estado !== "") {
        paramCount++;
        query += ` AND activo = $${paramCount}`;
        params.push(
          queryParams.estado === "true" || queryParams.estado === true
        );
      }

      // Filtro por C√©dula (b√∫squeda parcial)
      if (queryParams.cedula) {
        paramCount++;
        query += ` AND id_coordinador::text LIKE $${paramCount}`;
        params.push(`%${queryParams.cedula}%`);
      }

      // Filtro por Nombre (b√∫squeda parcial)
      if (queryParams.nombre) {
        paramCount++;
        query += ` AND (nombres ILIKE $${paramCount}`;
        params.push(`%${queryParams.nombre}%`);

        paramCount++;
        query += ` OR apellidos ILIKE $${paramCount})`;
        params.push(`%${queryParams.nombre}%`);
      }

      // Filtro por Email (b√∫squeda parcial)
      if (queryParams.email) {
        paramCount++;
        query += ` AND email ILIKE $${paramCount}`;
        params.push(`%${queryParams.email}%`);
      }

      // Filtro por PNF
      if (queryParams.pnf) {
        paramCount++;
        query += ` AND id_pnf = $${paramCount}`;
        params.push(parseInt(queryParams.pnf));
      }

      // --- 2. Aplicar Ordenamiento ---

      if (queryParams.sort) {
        // Campos permitidos para ordenar
        const allowedSortFields = [
          "id_coordinador",
          "nombres",
          "apellidos",
          "email",
          "activo",
          "nombre_pnf",
          "created_at",
          "updated_at",
        ];

        const sortField = allowedSortFields.includes(
          queryParams.sort.toLowerCase()
        )
          ? queryParams.sort.toLowerCase()
          : "created_at"; // Default

        const sortOrder =
          queryParams.order?.toUpperCase() === "DESC" ? "DESC" : "ASC";

        query += ` ORDER BY ${sortField} ${sortOrder}`;
      } else {
        // Ordenamiento por defecto
        query += ` ORDER BY created_at DESC`;
      }

      // --- 3. Aplicar Paginaci√≥n ---

      if (queryParams.limit) {
        const limit = parseInt(queryParams.limit);
        const offset = queryParams.page
          ? (parseInt(queryParams.page) - 1) * limit
          : 0;

        paramCount++;
        query += ` LIMIT $${paramCount}`;
        params.push(limit);

        if (offset > 0) {
          paramCount++;
          query += ` OFFSET $${paramCount}`;
          params.push(offset);
        }
      }

      // üöÄ Ejecutar la consulta con par√°metros
      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinadores obtenidos exitosamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.obtenerTodos" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener los coordinadores"
      );
    }
  }

  static async listarCoordinadoresDestituidos(queryParams = {}) {
    try {
      let query = `SELECT * FROM public.coordinadores_destituidos_completos WHERE 1=1`;
      const params = [];
      let paramCount = 0;

      // Mantener otros filtros
      if (queryParams.id_pnf) {
        paramCount++;
        query += ` AND id_pnf = $${paramCount}`;
        params.push(queryParams.id_pnf);
      }

      if (queryParams.nombre_pnf) {
        paramCount++;
        query += ` AND nombre_pnf ILIKE $${paramCount}`;
        params.push(`%${queryParams.nombre_pnf}%`);
      }

      if (queryParams.cedula) {
        paramCount++;
        query += ` AND cedula = $${paramCount}`;
        params.push(queryParams.cedula);
      }

      // Aplicar ordenamiento
      if (queryParams.sort) {
        const allowedSortFields = [
          "nombres",
          "apellidos",
          "nombre_pnf",
          "fecha_ingreso",
          "fecha_destitucion",
          "fecha_designacion",
        ];
        const sortField = allowedSortFields.includes(queryParams.sort)
          ? queryParams.sort
          : "nombres";
        const sortOrder =
          queryParams.order?.toUpperCase() === "DESC" ? "DESC" : "ASC";
        query += ` ORDER BY ${sortField} ${sortOrder}`;
      } else {
        query += ` ORDER BY fecha_destitucion DESC, nombres ASC`; // Orden por destituci√≥n reciente
      }

      // Aplicar paginaci√≥n
      if (queryParams.limit) {
        const limit = parseInt(queryParams.limit);
        const offset = queryParams.page
          ? (parseInt(queryParams.page) - 1) * limit
          : 0;

        paramCount++;
        query += ` LIMIT $${paramCount}`;
        params.push(limit);

        if (offset > 0) {
          paramCount++;
          query += ` OFFSET $${paramCount}`;
          params.push(offset);
        }
      }

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Listado de coordinadores destituidos obtenido correctamente"
      );
    } catch (error) {
      error.details = {
        path: "CoordinadorModel.listarCoordinadoresDestituidos",
      };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener coordinadores destituidos"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerCoordinador
   * @description Obtiene un coordinador espec√≠fico por su c√©dula
   * @param {number} cedula - C√©dula del coordinador
   * @returns {Promise&lt;Object>} Datos del coordinador
   */
  static async obtenerCoordinador(cedula) {
    try {
      const query = `
        SELECT * FROM public.coordinadores_informacion_completa 
        WHERE cedula = $1
      `;
      const params = [cedula];

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador obtenido correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.obtenerCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerCoordinadorPorId
   * @description Obtiene un coordinador espec√≠fico por su ID de coordinador
   * @param {number} id_coordinador - ID del coordinador
   * @returns {Promise&lt;Object>} Datos del coordinador
   */
  static async obtenerCoordinadorPorId(id_coordinador) {
    try {
      const query = `
        SELECT * FROM public.coordinadores_informacion_completa 
        WHERE id_coordinador = $1
      `;
      const params = [id_coordinador];

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador obtenido correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.obtenerCoordinadorPorId" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener coordinador por ID"
      );
    }
  }

  /**
   * @static
   * @async
   * @method actualizarCoordinador
   * @description Actualiza los datos de un coordinador existente
   * @param {number} id_coordinador - ID del coordinador a actualizar
   * @param {Object} datos - Datos actualizados del coordinador
   * @param {number} id_usuario - ID del usuario que realiza la acci√≥n
   * @returns {Promise&lt;Object>} Resultado de la operaci√≥n
   */
  static async actualizarCoordinador(id_coordinador, datos, id_usuario) {
    try {
      // Construir la consulta din√°micamente basada en los campos proporcionados
      const campos = [];
      const params = [];
      let paramCount = 0;

      // Campos permitidos para actualizaci√≥n
      const camposPermitidos = [
        "fecha_inicio",
        "fecha_fin",
        "observaciones",
        "estado",
        "motivo_destitucion",
      ];

      for (const [campo, valor] of Object.entries(datos)) {
        if (camposPermitidos.includes(campo) &amp;&amp; valor !== undefined) {
          paramCount++;
          campos.push(`${campo} = $${paramCount}`);
          params.push(valor);
        }
      }

      if (campos.length === 0) {
        return FormatterResponseModel.respuestaPostgres(
          [],
          "No hay campos v√°lidos para actualizar"
        );
      }

      // Agregar ID del coordinador y usuario que actualiza
      paramCount++;
      params.push(id_coordinador);
      paramCount++;
      params.push(id_usuario);

      const query = `
        UPDATE public.coordinadores 
        SET ${campos.join(
          ", "
        )}, fecha_actualizacion = CURRENT_TIMESTAMP, id_usuario_actualizacion = $${paramCount}
        WHERE id_coordinador = $${paramCount - 1}
      `;

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador actualizado correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.actualizarCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al actualizar coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method destituirCoordinador
   * @description Destituye un coordinador mediante un procedimiento almacenado
   * @param {number} id_coordinador - ID del coordinador a destituir
   * @param {number} id_usuario - ID del usuario que realiza la acci√≥n
   * @param {string} tipo_accion - Tipo de acci√≥n (DESTITUCION, RENUNCIA)
   * @param {string} razon - Raz√≥n de la destituci√≥n
   * @param {string} observaciones - Observaciones adicionales (opcional)
   * @param {string} fecha_efectiva - Fecha efectiva de la destituci√≥n (opcional)
   * @returns {Promise&lt;Object>} Resultado de la operaci√≥n
   */
  static async destituirCoordinador(
    id_coordinador,
    id_usuario,
    tipo_accion,
    razon,
    observaciones = null,
    fecha_efectiva = null
  ) {
    try {
      const query = `CALL eliminar_destituir_coordinador(NULL, $1, $2, $3, $4, $5, $6)`;
      const params = [
        id_usuario,
        id_coordinador,
        tipo_accion,
        razon,
        observaciones,
        fecha_efectiva,
      ];

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador destituido correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.destituirCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al destituir coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method restituirCoordinador
   * @description Restituye (reingresa) un coordinador destituido mediante un procedimiento almacenado
   * @param {number} id_coordinador - ID del coordinador a restituir
   * @param {number} id_usuario - ID del usuario que realiza la acci√≥n
   * @param {string} tipo_reingreso - Tipo de reingreso (REINGRESO, REINCORPORACION, REINTEGRO)
   * @param {string} motivo_reingreso - Motivo del reingreso
   * @param {string} observaciones - Observaciones adicionales (opcional)
   * @param {string} fecha_efectiva - Fecha efectiva del reingreso (opcional)
   * @param {number} registro_anterior_id - ID del registro de destituci√≥n anterior (opcional)
   * @param {number} id_pnf - ID del PNF al que se reasigna (opcional)
   * @returns {Promise&lt;Object>} Resultado de la operaci√≥n
   */
  static async restituirCoordinador(
    id_coordinador,
    id_usuario,
    tipo_reingreso,
    motivo_reingreso,
    observaciones = null,
    fecha_efectiva = null,
    registro_anterior_id = null,
    id_pnf = null
  ) {
    try {
      const query = `CALL reingresar_coordinador(NULL, $1, $2, $3, $4, $5, $6, $7, $8)`;
      const params = [
        id_usuario,
        id_coordinador,
        tipo_reingreso,
        motivo_reingreso,
        observaciones,
        fecha_efectiva,
        registro_anterior_id,
        id_pnf,
      ];

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Coordinador restituido correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.restituirCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al restituir coordinador"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerHistorialDestituciones
   * @description Obtiene el historial de destituciones de un coordinador
   * @param {number} id_coordinador - ID del coordinador
   * @returns {Promise&lt;Object>} Historial de destituciones
   */
  static async obtenerHistorialDestituciones(id_coordinador) {
    try {
      const query = `
        SELECT 
          d.id_registro,
          d.tipo_accion,
          d.razon,
          d.observaciones,
          d.fecha_efectiva,
          d.created_at,
          u.nombres || ' ' || u.apellidos as usuario_accion_nombre
        FROM destituciones d
        INNER JOIN coordinadores c ON d.usuario_id = c.id_profesor
        INNER JOIN users u ON d.usuario_accion = u.cedula
        WHERE c.id_coordinador = $1 AND d.rol_id = 2
        ORDER BY d.created_at DESC
      `;

      const { rows } = await pg.query(query, [id_coordinador]);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Historial obtenido correctamente"
      );
    } catch (error) {
      error.details = {
        path: "CoordinadorModel.obtenerHistorialDestituciones",
      };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener historial de destituciones"
      );
    }
  }

  /**
   * @static
   * @async
   * @method obtenerHistorialCoordinador
   * @description Obtiene el historial completo de coordinaciones de un profesor
   * @param {number} cedula_profesor - C√©dula del profesor
   * @returns {Promise&lt;Object>} Historial de coordinaciones
   */
  static async obtenerHistorialCoordinador(cedula_profesor) {
    try {
      const query = `
        SELECT * FROM public.coordinadores_informacion_completa 
        WHERE cedula = $1 
        ORDER BY fecha_inicio DESC
      `;
      const params = [cedula_profesor];

      const { rows } = await pg.query(query, params);

      return FormatterResponseModel.respuestaPostgres(
        rows,
        "Historial de coordinador obtenido correctamente"
      );
    } catch (error) {
      error.details = { path: "CoordinadorModel.obtenerHistorialCoordinador" };
      throw FormatterResponseModel.respuestaError(
        error,
        "Error al obtener historial de coordinador"
      );
    }
  }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Thu Dec 04 2025 12:35:39 GMT-0400 (hora de Venezuela) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
