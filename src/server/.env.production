# ============================================
# ENVIRONMENT & APP CONFIGURATION
# ============================================
NODE_ENV=production
APP_NAME=UPTAMCA
APP_VERSION=1.0.0
APP_DESCRIPTION=Servidor API UPTAMCA - Producción
API_URL=https://api.uptamca.edu
WS_URL=wss://api.uptamca.edu

# ============================================
# SERVER CONFIGURATION
# ============================================
PORT=3001
HOST=0.0.0.0
PROTOCOL=https
BASE_URL=https://api.uptamca.edu
API_PREFIX=/api/v1
SERVER_NAME=UPTAMCA Production Server

# ============================================
# DATABASE CONFIGURATION
# ============================================
DATABASE_CONNECTION_URL=
DATABASE_URL_EXTERNAL=
DATABASE_CLIENT=pg
DB_HOST=localhost
DB_PORT=5432
DB_NAME=uptamca_production
DB_USER=uptamca_user
DB_PASSWORD=your_strong_db_password_here
DB_SSL=true
DB_DEBUG=false
DB_ASYNC_STACK_TRACES=false
DB_SCHEMA=public
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_ACQUIRE=60000
DB_POOL_IDLE=30000
DB_REAP_INTERVAL=1000
DB_CREATE_RETRY_INTERVAL=200
DB_CREATE_TIMEOUT=60000
DB_RETRY_COUNT=5
DB_RETRY_DELAY=2000
DB_MIGRATIONS_DIR=./migrations
DB_SEEDS_DIR=./seeds

# ============================================
# CORS CONFIGURATION
# ============================================
CORS_ALLOWED_ORIGINS=https://app.uptamca.edu,https://admin.uptamca.edu,https://uptamca.edu
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,Accept,Origin,X-CSRF-Token,X-Request-ID
CORS_EXPOSED_HEADERS=Authorization,X-CSRF-Token,X-Request-ID,X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset
CORS_PREFLIGHT_CONTINUE=false
CORS_OPTIONS_SUCCESS_STATUS=204
CORS_MAX_AGE=86400
CORS_DEV_ALLOW_ALL=false
CORS_DEV_LOG_BLOCKED=true
CORS_DEV_SHOW_DEBUG=false
CORS_ALLOW_NULL_ORIGIN=false
CORS_ALLOW_MOBILE_APPS=true
CORS_ALLOW_CHROME_EXTENSIONS=false
CORS_ALLOW_POSTMAN=false

# ============================================
# HELMET SECURITY HEADERS
# ============================================
CSP_ENABLED=true
CSP_REPORT_ONLY=false
CSP_SCRIPT_SRC='self' https://cdn.jsdelivr.net https://unpkg.com
CSP_STYLE_SRC='self' https://fonts.googleapis.com 'unsafe-inline'
CSP_IMG_SRC='self' data: https: blob:
CSP_FONT_SRC='self' https://fonts.gstatic.com data:
CSP_CONNECT_SRC='self' https://api.uptamca.edu wss://api.uptamca.edu
CSP_FRAME_SRC='none'
CSP_MEDIA_SRC='self' https:
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
CROSS_ORIGIN_EMBEDDER_POLICY=require-corp
CROSS_ORIGIN_OPENER_POLICY=same-origin-allow-popups
CROSS_ORIGIN_RESOURCE_POLICY=same-origin
DNS_PREFETCH_CONTROL=false
FRAME_GUARD_ACTION=DENY
HIDE_POWERED_BY=true
IE_NO_OPEN=true
NO_SNIFF=true
PERMITTED_CROSS_DOMAIN_POLICIES=none
REFERRER_POLICY=strict-origin-when-cross-origin
XSS_FILTER=true

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=200
RATE_LIMIT_MESSAGE=Demasiadas solicitudes, por favor intente más tarde
RATE_LIMIT_STANDARD_HEADERS=true
RATE_LIMIT_LEGACY_HEADERS=true
RATE_LIMIT_SKIP_SUCCESS=true
RATE_LIMIT_WHITELIST=127.0.0.1,::1
RATE_LIMIT_BLACKLIST=
LOGIN_RATE_LIMIT_WINDOW_MS=900000
LOGIN_RATE_LIMIT_MAX=10
REGISTER_RATE_LIMIT_WINDOW_MS=3600000
REGISTER_RATE_LIMIT_MAX=5
PASSWORD_RESET_RATE_LIMIT_WINDOW_MS=3600000
PASSWORD_RESET_RATE_LIMIT_MAX=5
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX=100
UPLOAD_RATE_LIMIT_WINDOW_MS=300000
UPLOAD_RATE_LIMIT_MAX=20

# ============================================
# CSRF PROTECTION
# ============================================
CSRF_ENABLED=true
CSRF_COOKIE_KEY=_csrf
CSRF_COOKIE_SECURE=true
CSRF_COOKIE_HTTP_ONLY=true
CSRF_COOKIE_SAME_SITE=strict
CSRF_COOKIE_PATH=/
CSRF_HEADER_NAME=X-CSRF-Token
CSRF_IGNORE_METHODS=GET,HEAD,OPTIONS

# ============================================
# MISC SECURITY SETTINGS
# ============================================
HIDE_SERVER_INFO=true
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=10000
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=9
COMPRESSION_THRESHOLD=1024
CACHE_CONTROL_HEADER=no-store, no-cache, must-revalidate, private

# ============================================
# SOCKET.IO CONFIGURATION
# ============================================
SOCKET_ENABLED=true
SOCKET_CORS_ORIGIN=https://app.uptamca.edu,https://admin.uptamca.edu
SOCKET_CORS_CREDENTIALS=true
SOCKET_TRANSPORTS=websocket
SOCKET_ALLOW_EIO3=false
SOCKET_PING_TIMEOUT=10000
SOCKET_PING_INTERVAL=25000
SOCKET_CONNECT_TIMEOUT=45000
SOCKET_ALLOW_UPGRADES=false
SOCKET_COMPRESSION=true
SOCKET_HTTP_COMPRESSION=true
SOCKET_AUTH_ENABLED=true
SOCKET_AUTH_TIMEOUT=5000
SOCKET_AUTH_REQUIRED=true
SOCKET_USER_ROOM_PREFIX=user_
SOCKET_ROLE_ROOM_PREFIX=role_
SOCKET_ADMIN_ROOM=role_SuperAdmin
SOCKET_BROADCAST_ROOM=broadcast
SOCKET_MAX_BUFFER_SIZE=5000000
SOCKET_MAX_CONNECTIONS=5000
SOCKET_MAX_PAYLOAD=5000000

# ============================================
# AUTHENTICATION & JWT CONFIGURATION
# ============================================
JWT_ACCESS_SECRET=REPLACE_WITH_STRONG_RANDOM_ACCESS_SECRET
JWT_REFRESH_SECRET=REPLACE_WITH_STRONG_RANDOM_REFRESH_SECRET
JWT_RESET_SECRET=REPLACE_WITH_STRONG_RANDOM_RESET_SECRET
JWT_VERIFY_SECRET=REPLACE_WITH_STRONG_RANDOM_VERIFY_SECRET
AUTH_SECRET_KEY=REPLACE_WITH_STRONG_RANDOM_AUTH_SECRET
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_RESET_EXPIRES_IN=1h
JWT_VERIFY_EXPIRES_IN=24h
JWT_SHORT_EXPIRES_IN=5m
JWT_LONG_EXPIRES_IN=30d
JWT_ALGORITHM=HS256
JWT_ISSUER=uptamca-api
JWT_AUDIENCE=uptamca-client
JWT_SUBJECT=user-auth
JWT_ID_PREFIX=jti_
ACCESS_TOKEN_NAME=access_token
REFRESH_TOKEN_NAME=refresh_token
RESET_TOKEN_NAME=reset_token
VERIFY_TOKEN_NAME=verify_token
BEARER_TOKEN_PREFIX=Bearer
TOKEN_SOURCES=header,cookie
TOKEN_COOKIE_SECURE=true
TOKEN_COOKIE_HTTP_ONLY=true
TOKEN_COOKIE_SAME_SITE=strict
TOKEN_COOKIE_PATH=/
TOKEN_COOKIE_DOMAIN=.uptamca.edu
TOKEN_COOKIE_MAX_AGE=604800000
BCRYPT_SALT_ROUNDS=12
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_TIME_MINUTES=30
TOKEN_REFRESH_LIMIT=10
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SYMBOL=true
JWT_REQUIRED_CLAIMS=sub,iat,exp,iss,aud
JWT_ADDITIONAL_CLAIMS=role,email,name,userId,permissions
USE_TOKEN_BLACKLIST=true
BLACKLIST_TTL_HOURS=72
REFRESH_TOKEN_LENGTH=128
REFRESH_TOKEN_STORE=redis
REFRESH_TOKEN_REUSE_DETECTION=true
REFRESH_TOKEN_FAMILY_LIMIT=10
REFRESH_RATE_LIMIT_WINDOW_MS=30000
REFRESH_RATE_LIMIT_MAX=5

# ============================================
# OAUTH & SOCIAL LOGIN
# ============================================
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID
GOOGLE_CLIENT_SECRET=YOUR_GOOGLE_CLIENT_SECRET
GOOGLE_CALLBACK_URL=https://api.uptamca.edu/auth/google/callback
GITHUB_CLIENT_ID=YOUR_GITHUB_CLIENT_ID
GITHUB_CLIENT_SECRET=YOUR_GITHUB_CLIENT_SECRET
GITHUB_CALLBACK_URL=https://api.uptamca.edu/auth/github/callback

# ============================================
# FILE UPLOADS CONFIGURATION
# ============================================
PATH_FILES=/var/www/uploads
PATH_TEMP_FILES=/tmp/uploads
MAX_SIZE_IMAGE_FILES=10
MAX_SIZE_DOCUMENT_FILES=20
MAX_SIZE_VIDEO_FILES=100
MAX_SIZE_FILES=10
MAX_FILES_UPLOAD=20
GENERATE_UNIQUE_NAME=true

# ============================================
# LOGGING CONFIGURATION
# ============================================
LOG_LEVEL=warn
LOG_TIMESTAMP_FORMAT=YYYY-MM-DD HH:mm:ss
LOG_FORMAT=json
LOG_ERROR_FILE=/var/log/uptamca/error.log
LOG_COMBINED_FILE=/var/log/uptamca/combined.log
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=10
LOG_CONSOLE=false
LOG_EXCEPTIONS_FILE=/var/log/uptamca/exceptions.log

# ============================================
# SESSION CONFIGURATION
# ============================================
SESSION_ENABLED=true
SESSION_SECRET=REPLACE_WITH_STRONG_RANDOM_SESSION_SECRET
SESSION_STORE_TYPE=redis
SESSION_COOKIE_NAME=uptamca.sid
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict
SESSION_COOKIE_PATH=/
SESSION_MAX_AGE=86400000
SESSION_RESAVE=false
SESSION_SAVE_UNINITIALIZED=false
SESSION_PROXY=true
SESSION_ROLLING=true
SESSION_TTL=86400
REDIS_HOST=redis.uptamca.edu
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_SESSION_DB=1
MONGO_SESSION_URL=
SESSION_COLLECTION=sessions

# ============================================
# COOKIE CONFIGURATION
# ============================================
COOKIE_SECRET=REPLACE_WITH_STRONG_RANDOM_COOKIE_SECRET
COOKIE_HTTP_ONLY=true
COOKIE_SECURE=true
COOKIE_SAME_SITE=strict

# ============================================
# BODY PARSER CONFIGURATION
# ============================================
JSON_BODY_LIMIT=10mb
JSON_STRICT=true
JSON_TYPE=application/json
URL_ENCODED_LIMIT=10mb
URL_ENCODED_EXTENDED=true
URL_ENCODED_PARAM_LIMIT=1000
MULTIPART_ENABLED=true
UPLOAD_DIR=/var/www/uploads
KEEP_EXTENSIONS=true
MAX_FILE_SIZE=20971520
MAX_FIELDS=50
MAX_FILES=5
ALLOW_EMPTY_FILES=false
TEXT_BODY_LIMIT=1mb
TEXT_DEFAULT_CHARSET=utf-8
TEXT_TYPE=text/plain
RAW_BODY_LIMIT=5mb
RAW_TYPE=application/octet-stream

# ============================================
# REDIS CONFIGURATION (CACHE & SESSIONS)
# ============================================
REDIS_CACHE_HOST=redis.uptamca.edu
REDIS_CACHE_PORT=6379
REDIS_CACHE_PASSWORD=your_redis_password_here
REDIS_CACHE_DB=2
REDIS_CACHE_TTL=3600

# ============================================
# MONITORING & METRICS
# ============================================
METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true
HEALTH_ENDPOINT=/health
HEALTH_TIMEOUT=10000
METRICS_ENDPOINT=/metrics
COLLECT_DEFAULT_METRICS=true

# ============================================
# BACKUP CONFIGURATION
# ============================================
BACKUP_ENABLED=true
BACKUP_INTERVAL=86400000
MAX_BACKUPS=30
BACKUP_COMPRESSION=true
BACKUP_DIR=/var/backups/uptamca

# ============================================
# NOTIFICATIONS CONFIGURATION
# ============================================
NOTIFICATIONS_ENABLED=true
NOTIFICATIONS_REALTIME=true
NOTIFICATIONS_PERSISTENCE=true
NOTIFICATIONS_MAX_HISTORY=1000
